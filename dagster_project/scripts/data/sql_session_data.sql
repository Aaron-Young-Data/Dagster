SELECT
	CONCAT(DAT.DRIVER, '-', DAT.DRIVER_NUMBER) AS DRIVER,
	DAT.LAPTIME_FP1,
    DAT.COMPOUND_FP1,
    DAT.AIR_TEMP_FP1,
    DAT.RAINFALL_FP1,
    DAT.TRACK_TEMP_FP1,
    LAPTIME_FP2,
    COMPOUND_FP2,
    AIR_TEMP_FP2,
	RAINFALL_FP2,
    TRACK_TEMP_FP2,
    LAPTIME_FP3,
    COMPOUND_FP3,
    AIR_TEMP_FP3,
	RAINFALL_FP3,
    TRACK_TEMP_FP3,
    FCST.TEMPERATURE AS AIR_TEMP_Q,
    FCST.PRECIPITATION_PROB AS RAINFALL_Q,
    CASE WHEN EVENT_TYPE_CD = 1 THEN 0 ELSE 0 END AS IS_SPRINT,
	TRK.TRACTION,
    TRK.TYRE_STRESS,
    TRK.ASPHALT_GRIP,
    TRK.BRAKING,
    TRK.ASPHALT_ABRASION,
    TRK.LATERAL_FORCE,
    TRK.TRACK_EVOLUTION,
    TRK.DOWNFORCE
FROM CLEANED_SESSION_DATA DAT
LEFT JOIN DIM_EVENT EVT
	ON EVT.EVENT_CD = DAT.EVENT_CD
LEFT JOIN DIM_TRACK TRK
	ON EVT.TRACK_CD = TRK.TRACK_CD
LEFT JOIN WEATHER_FORECAST FCST
	ON DATE_FORMAT(EVT.SESSION_FOUR_DT, '%Y-%m-%d %H:00:00') = FCST.FCST_DATETIME
    AND EVT.FCST_LOCATION = FCST.FCST_LOCATION
WHERE DAT.EVENT_CD = '{event_cd}'