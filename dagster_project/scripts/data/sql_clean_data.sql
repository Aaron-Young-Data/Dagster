SELECT
LapTimeFP1,
CompoundFP1,
AirTempFP1,
RainfallFP1,
TrackTempFP1,
IFNULL(LapTimeFP2, 0) AS LapTimeFP2,
IFNULL(CompoundFP2, 0) AS CompoundFP2,
IFNULL(AirTempFP2, 0) AS AirTempFP2,
IFNULL(RainfallFP2, 0) AS RainfallFP2,
IFNULL(TrackTempFP2, 0) AS TrackTempFP2,
IFNULL(LapTimeFP3, 0) AS LapTimeFP3,
IFNULL(CompoundFP3, 0) AS CompoundFP3,
IFNULL(AirTempFP3, 0) AS AirTempFP3,
IFNULL(RainfallFP3, 0) AS RainfallFP3,
IFNULL(TrackTempFP3, 0) AS TrackTempFP3,
LapTimeQ,
AirTempQ,
RainfallQ,
sprint_flag as is_sprint,
traction,
tyre_stress,
asphalt_grip,
braking,
asphalt_abrasion,
lateral_force,
track_evolution,
downforce
FROM cleaned_session_data
where sprint_flag = 1 and
LapTimeQ is not NULL
UNION
SELECT
LapTimeFP1,
CompoundFP1,
AirTempFP1,
RainfallFP1,
TrackTempFP1,
LapTimeFP2,
CompoundFP2,
AirTempFP2,
RainfallFP2,
TrackTempFP2,
LapTimeFP3,
CompoundFP3,
AirTempFP3,
RainfallFP3,
TrackTempFP3,
LapTimeQ,
AirTempQ,
RainfallQ,
sprint_flag as is_sprint,
traction,
tyre_stress,
asphalt_grip,
braking,
asphalt_abrasion,
lateral_force,
track_evolution,
downforce
FROM cleaned_session_data
where sprint_flag = 0 and
LapTimeQ is not NULL