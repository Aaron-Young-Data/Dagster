SELECT
    P.DRIVER_ID,
    CONCAT('#',C.CONSTRUCTOR_COLOUR) AS CONSTRUCTOR_COLOUR,
    IFNULL(P.FP1_LAPTIME, 0) AS LAPTIME_FP1,
    IFNULL(P.FP1_SECTOR1_TIME, 0) AS SECTOR1_TIME_FP1,
    IFNULL(P.FP1_SECTOR2_TIME, 0) AS SECTOR2_TIME_FP1,
    IFNULL(P.FP1_SECTOR3_TIME, 0) AS SECTOR3_TIME_FP1,
    CASE WHEN P.FP1_LAPTIME IS NULL THEN 1 ELSE 0 END AS FP1_MISSING,
    IFNULL(P.FP2_LAPTIME, 0) AS LAPTIME_FP2,
    IFNULL(P.FP2_SECTOR1_TIME, 0) AS SECTOR1_TIME_FP2,
    IFNULL(P.FP2_SECTOR2_TIME, 0) AS SECTOR2_TIME_FP2,
    IFNULL(P.FP2_SECTOR3_TIME, 0) AS SECTOR3_TIME_FP2,
    CASE WHEN P.FP2_LAPTIME IS NULL THEN 1 ELSE 0 END AS FP2_MISSING,
    IFNULL(P.FP3_LAPTIME, 0) AS LAPTIME_FP3,
    IFNULL(P.FP3_SECTOR1_TIME, 0) AS SECTOR1_TIME_FP3,
    IFNULL(P.FP3_SECTOR2_TIME, 0) AS SECTOR2_TIME_FP3,
    IFNULL(P.FP3_SECTOR3_TIME, 0) AS SECTOR3_TIME_FP3,
    CASE WHEN P.FP3_LAPTIME IS NULL THEN 1 ELSE 0 END AS FP3_MISSING
FROM SESSION.CLEANED_PRACTICE_DATA P
LEFT JOIN REFERENCE.DIM_EVENT E
    ON E.EVENT_CD = P.EVENT_CD
LEFT JOIN REFERENCE.DIM_CONSTRUCTOR C
    ON P.TEAM_ID = C.CONSTRUCTOR_ID
WHERE
    E.EVENT_CD = {year}{round_num}